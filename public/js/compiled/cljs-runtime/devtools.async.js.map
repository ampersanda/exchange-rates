{"version":3,"file":"devtools.async.js","sources":["devtools/async.cljs"],"mappings":";;;AAIA,kCAAA,lCAAgBI;AAAhB,AACE,eAAAE;;AAEF,uCAAA,vCAAeN;AACf,oDAAA,pDAAeO;AAGf,yCAAA,zCAAMK,0FAAyBE;AAC7B,kBAAA,XAACD,PADH;AACE,AAAgB,MAAOC;GAAvB;;AAEF,6CAAA,7CAAMJ,kGAA6BS;iEAC7B,iBAAAd,mBAAOC,rGAEP,IAAAD,JAHN,6BAEM,iBAAAA;AADA,AAAA,OAAA,CAAAA,iBAAA,iBAAAA;;AACA,AAAA,OAAA,CAAAA,iBAAA,cAAAA,iBAAcc;;AACd,AAAA,AAAA,CAAAd,uBAAA,eAAAA,uBAAeO;;AAHrB;;AAMA,mDAAA,nDAAMX;AAAN,AACE,AAAMM,oDAAyBC;;AAC/B,OAAMA,oCAAwBE;;AAEhC,qDAAA,rDAAMR;AAAN,AACE,OAAMM,oCAAwBD;;AAIhC,kCAAA,lCAAMI;AAAN,AACEX;;AAEF,+BAAA,/BAAMS;AAAN,AACE,GAAUT;AAAV;;AAAA,AACE,uCAAA,vCAAMA;;AACN,IAAAe,iBAAME;IAAND,8BAAAD;AAAA,AAAA,oBAAAC;AAAA;AAAA,AAAA,MAAA,KAAAC,MAAA,CAAA,8DAAA,CAAA,4EAAA,MAAA,mDAAAF,2BAAA,KAAA;;;AAAA,CAAAC,4BAAA,qBAAmCE;;AAAnCH;AACA,AAACd;;AAHH;;;AAMF,iCAAA,jCAAME;AAAN,AACE,GAAMH;AAAN,AACE,uCAAA,vCAAMA;;AACN,OAACE;;AAFH","names":["devtools.async/*installed*","devtools.async/install-async-set-immediate!","devtools.async/uninstall-async-set-immediate!","devtools.async/uninstall!","devtools.async/available?","o__13287__auto__","js/Promise","devtools.async/*original-set-immediate*","goog.async.nextTick/setImmediate_","devtools.async/install!","devtools.async/promise-based-set-immediate","devtools.async/installed?","devtools.async/rethrow-outside-promise","js/setTimeout","e","G__15195","target__13296__auto__","js/Error","js/Infinity","callback"],"sourcesContent":["(ns devtools.async\n  (:require-macros [devtools.oops :refer [oset ocall]])\n  (:require [goog.async.nextTick :as next-tick]))\n\n(defn ^:dynamic available? []\n  (exists? js/Promise))\n\n(def ^:dynamic *installed* false)\n(def ^:dynamic *original-set-immediate* nil)\n\n; see http://stackoverflow.com/a/30741722/84283\n(defn rethrow-outside-promise [e]\n  (js/setTimeout #(throw e) 0))\n\n(defn promise-based-set-immediate [callback]\n  (-> (ocall js/Promise \"resolve\")\n      (ocall \"then\" callback)\n      (ocall \"catch\" rethrow-outside-promise))\n  nil)\n\n(defn install-async-set-immediate! []\n  (set! *original-set-immediate* next-tick/setImmediate_)\n  (set! next-tick/setImmediate_ promise-based-set-immediate))\n\n(defn uninstall-async-set-immediate! []\n  (set! next-tick/setImmediate_ *original-set-immediate*))\n\n; -- installation -----------------------------------------------------------------------------------------------------------\n\n(defn installed? []\n  *installed*)\n\n(defn install! []\n  (when-not *installed*\n    (set! *installed* true)\n    (oset js/Error [\"stackTraceLimit\"] js/Infinity)\n    (install-async-set-immediate!)\n    true))\n\n(defn uninstall! []\n  (when *installed*\n    (set! *installed* false)\n    (uninstall-async-set-immediate!)))\n"]}